# ESTA APLICACION ESTA DESAROLLADA POR UN TECNICO INFORMATICO CON POCOS CONOCIMIENTOS DE PROGRAMACION, DESARROLLADA INTEGRAMENTE USANDO IA SIN EDITAR A MANO NI UNA SOLA LINEA DE CODIGO
# HA EMPEZADO SIENDO UN EXPERIMENTO, Y HA CONTINUADO INTENTANDO HACER UNA APLICACION FUNCIONAL
# PODRIA VALER PARA SU PROPOSITO, ESTA RELATIVAMENTE TESTEADA PERO, COMO SE PODRA OBSERVAR, NO ESTA LIMPIA DE FICHEROS INUTILES QUE SE HAN IDO GENERANDO

# AL QUE LE PUEDA VALER, LIBRE ES DE HACER CON ELLA LO QUE DESEE, Y YO ESTARIA ENCANTADO DE RECIBIR FEEDBACK, AUNQUE SOLO SEA POR CURIOSIDAD DE QUE A ALGUIEN LE HA PODIDO SER UTIL
## NACHO@FAVALA.ES

# Gesti√≥n de Socios - Asociaci√≥n

Sistema web integral para la gesti√≥n completa de asociaciones y entidades sin √°nimo de lucro. Desarrollado en PHP nativo con MySQL, incluye gesti√≥n de socios, donantes, eventos, finanzas, proveedores, libro de fiestas y mucho m√°s.

## üöÄ Caracter√≠sticas Principales

### üë• Gesti√≥n de Socios
- **Categor√≠as de socios** con cuotas personalizadas por categor√≠a
- Alta, baja, edici√≥n y listado con foto de perfil
- Campo DNI/NIE para identificaci√≥n oficial
- **Geolocalizaci√≥n GPS** con captura desde m√≥vil o entrada manual
- Generaci√≥n autom√°tica de n√∫mero de socio
- **Historial de im√°genes** con comparaci√≥n y restauraci√≥n
- B√∫squeda avanzada y filtrado por categor√≠a, estado, etc.
- Exportaci√≥n a Excel y PDF
- **Generaci√≥n masiva de pagos** por categor√≠a y a√±o

### üí∞ Gesti√≥n Financiera
- **Dashboard de Tesorer√≠a** con KPIs en tiempo real
- **Gesti√≥n de Pagos** con estados (pendiente, pagado, vencido)
- **Gesti√≥n de Gastos** con categor√≠as personalizables
- **Proveedores** con seguimiento de facturas y pagos
- Gr√°ficos de evoluci√≥n de ingresos y gastos
- Reportes financieros exportables
- Control de morosos y pagos vencidos

### üßÆ Contabilidad Avanzada
- **Plan de Cuentas** personalizable (activos, pasivos, patrimonio, ingresos, gastos)
- **Contabilidad por Partida Doble** con validaci√≥n autom√°tica
- **Libro Diario** con asientos contables (borradores y contabilizados)
- **Libro Mayor** por cuenta con saldos acumulados
- **Balance de Sumas y Saldos** con verificaci√≥n autom√°tica
- **Per√≠odos Contables** para organizaci√≥n por ejercicio fiscal
- Asientos manuales y autom√°ticos desde otros m√≥dulos
- C√≥digos de cuenta compatibles con Plan General Contable espa√±ol
- Reportes contables exportables

### üéÅ Gesti√≥n de Donantes
- Registro de empresas y particulares donantes
- **Galer√≠a de im√°genes** con historial y comparaci√≥n
- Geolocalizaci√≥n de donantes con GPS
- Seguimiento de contactos y donaciones
- Gesti√≥n de logos y datos de contacto
- Exportaci√≥n de datos

### üìÖ Gesti√≥n de Eventos
- Creaci√≥n y edici√≥n de eventos
- **Dashboard de eventos** con estad√≠sticas
- Control de asistencia y participantes
- Gesti√≥n de pagos por evento
- Calendario interactivo
- Reportes de eventos

### üìñ Libro de Fiestas
- **Gesti√≥n de anunciantes** con diferentes tipos de anuncios
- **Precios por a√±o** configurables (media p√°gina, p√°gina completa, portada, contraportada)
- **Actividades** del programa de fiestas
- **Dashboard del libro** con estad√≠sticas de ventas
- **Maquetaci√≥n y exportaci√≥n** a PDF y DOCX
- **Sistema de versiones** para guardar diferentes ediciones
- **Editor visual** con arrastrar y soltar p√°ginas
- Generaci√≥n autom√°tica de contenido

### üó∫Ô∏è Geolocalizaci√≥n y Mapas
- **Mapa interactivo** con Leaflet.js y OpenStreetMap
- Captura de coordenadas GPS desde dispositivos m√≥viles
- Entrada manual de coordenadas (compatible con HTTP)
- Visualizaci√≥n combinada de socios y donantes
- **Etiquetas con nombres** al hacer zoom
- Filtros: mostrar todos, solo socios, solo donantes
- Marcadores diferenciados por color
- Enlaces directos a Google Maps
- Dise√±o responsive para m√≥vil y desktop

### üìã Gesti√≥n de Tareas
- Crear, editar y asignar tareas
- Estados: pendiente, en progreso, completada, cancelada
- Prioridades: baja, normal, alta, urgente
- Fechas de vencimiento y seguimiento
- Historial de cambios
- Comentarios y notas

### üìä Anal√≠ticas y Reportes
- **Dashboard principal** con estad√≠sticas en tiempo real
- **Dashboard de tesorer√≠a** con KPIs financieros
- **Dashboard de eventos** con m√©tricas de participaci√≥n
- **Dashboard de proveedores** con estado de facturas
- Gr√°ficos de evoluci√≥n de socios, ingresos y gastos
- Reportes de pagos y morosos
- Exportaci√≥n de datos a Excel y PDF

### üì¢ Anuncios P√∫blicos
- Creaci√≥n de anuncios para la web p√∫blica
- Gesti√≥n de visibilidad (activo/inactivo)
- Fechas de publicaci√≥n y caducidad
- Editor de contenido enriquecido

### üñºÔ∏è Galer√≠a de Im√°genes
- Galer√≠a unificada de fotos de socios y logos de donantes
- Navegaci√≥n por pesta√±as
- Vista en cuadr√≠cula responsive
- Visualizaci√≥n ampliada de im√°genes

### üìÑ Documentos y Certificados
- **Gesti√≥n de documentos** con categor√≠as
- Generaci√≥n de certificados de socio en PDF
- Certificados de pago con desglose de cuotas
- Nombres de archivo descriptivos (DNI-Nombre)
- Almacenamiento organizado

### üîî Sistema de Notificaciones
- Notificaciones en tiempo real
- Contador de notificaciones no le√≠das
- Marcado como le√≠do individual o masivo
- Tipos: info, √©xito, advertencia, error

### üí¨ Mensajer√≠a Interna
- Sistema de mensajes entre usuarios
- Conversaciones directas
- Contador de mensajes no le√≠dos
- Historial de conversaciones

### üó≥Ô∏è Votaciones
- Creaci√≥n de encuestas y votaciones
- Opciones m√∫ltiples
- Resultados en tiempo real
- Control de cierre de votaciones

### üîç B√∫squeda Global
- B√∫squeda unificada en toda la aplicaci√≥n
- Resultados categorizados
- B√∫squeda r√°pida desde cualquier p√°gina

### üîê Seguridad y Auditor√≠a
- **Registro de auditor√≠a** completo de todas las acciones
- Exportaci√≥n de logs a Excel y PDF
- Control de acceso por roles (admin, usuario)
- **Pol√≠tica de contrase√±as** configurable
- Protecci√≥n CSRF en formularios
- Sesiones seguras

### ‚öôÔ∏è Configuraci√≥n Avanzada
- **Gesti√≥n de la organizaci√≥n** (nombre, CIF, direcci√≥n, contacto)
- **Logo y colores corporativos** personalizables
- **Junta directiva** configurable
- **Administraci√≥n de usuarios** del sistema
- **Configuraci√≥n de notificaciones**
- **Copias de seguridad** de base de datos
- **Configuraci√≥n de base de datos**
- Interfaz moderna con modo claro/oscuro

## üìã Requisitos del Sistema

### Servidor
- **Sistema Operativo**: Linux (Ubuntu 20.04+, Debian 10+, CentOS 7+) o Windows Server
- **Servidor Web**: Apache 2.4+ con `mod_rewrite` habilitado
- **PHP**: 7.4 o superior (recomendado PHP 8.0+)
- **Base de Datos**: MySQL 5.7+ o MariaDB 10.3+

### Extensiones PHP Requeridas
```bash
php-pdo
php-pdo-mysql
php-mbstring
php-json
php-curl
php-gd (para procesamiento de im√°genes)
php-zip (para exportaciones)
php-xml (para exportaci√≥n DOCX)
```

### Permisos del Sistema
- El usuario del servidor web (t√≠picamente `www-data` o `apache`) necesita permisos de escritura en:
  - `src/Config/` (configuraci√≥n)
  - `public/uploads/` (archivos subidos)
  - `public/uploads/members/` (fotos de socios)
  - `public/uploads/donors/` (logos de donantes)
  - `public/uploads/organization/` (logo institucional)
  - `public/uploads/receipts/` (comprobantes de gastos)
  - `public/uploads/documents/` (documentos)

### Navegadores Compatibles
- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- Opera 76+

### Para Geolocalizaci√≥n GPS
- **HTTPS**: Requerido para captura autom√°tica de GPS (restricci√≥n de seguridad HTML5)
- **HTTP**: Solo permite entrada manual de coordenadas
- **Permisos**: El usuario debe autorizar acceso a la ubicaci√≥n en el navegador

## üõ†Ô∏è Instalaci√≥n

### M√©todo R√°pido          

#### 1. Clonar el Repositorio

```bash
git clone https://github.com/matatunos/GestionSocios.git
cd GestionSocios
```

#### 2. Instalar Base de Datos

**Opci√≥n A: Script autom√°tico (Recomendado)**

```bash
cd database
chmod +x install.sh
./install.sh
```

El script te guiar√° paso a paso y:
- Crear√° la base de datos
- Importar√° el schema completo
- Opcionalmente crear√° un usuario espec√≠fico para la aplicaci√≥n
- Generar√° el archivo `config.php` autom√°ticamente
- Crear√° los directorios necesarios
- Opcionalmente importar√° datos de ejemplo

**Opci√≥n B: Instalaci√≥n manual**

```bash
# Acceder a MySQL
mysql -u root -p

# Crear base de datos y usuario
CREATE DATABASE asociacion_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'gestion_user'@'localhost' IDENTIFIED BY 'tu_password_segura';
GRANT ALL PRIVILEGES ON asociacion_db.* TO 'gestion_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;

# Importar schema
cd database
mysql -u gestion_user -p asociacion_db < schema.sql
```

**Nota**: El archivo `schema.sql` contiene la estructura completa de la base de datos.

#### 3. Configurar Aplicaci√≥n

**Si usaste el script de instalaci√≥n**, este paso ya est√° hecho. Salta al paso 4.

**Si instalaste manualmente**, edita `src/Config/config.php` con tus credenciales de base de datos:

```php
<?php
define('DB_HOST', 'localhost');
define('DB_NAME', 'asociacion_db');
define('DB_USER', 'gestion_user');
define('DB_PASS', 'tu_password_segura');
?>
```

#### 4. Configurar Servidor Web Apache

##### En Linux:
```bash
# Crear virtual host
sudo nano /etc/apache2/sites-available/gestion-socios.conf
```

Contenido del archivo:
```apache
<VirtualHost *:80>
    ServerName gestion-socios.local
    DocumentRoot /var/www/GestionSocios/public
    
    <Directory /var/www/GestionSocios/public>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    ErrorLog ${APACHE_LOG_DIR}/gestion-socios-error.log
    CustomLog ${APACHE_LOG_DIR}/gestion-socios-access.log combined
</VirtualHost>
```

```bash
# Habilitar sitio y mod_rewrite
sudo a2ensite gestion-socios.conf
sudo a2enmod rewrite
sudo systemctl restart apache2

# Configurar permisos
sudo chown -R www-data:www-data /var/www/GestionSocios
sudo chmod -R 755 /var/www/GestionSocios
sudo chmod -R 775 /var/www/GestionSocios/public/uploads
sudo chmod -R 775 /var/www/GestionSocios/src/Config
```

##### En Windows (XAMPP/WAMP):
1. Copiar la carpeta del proyecto a `C:\xampp\htdocs\GestionSocios`
2. Editar `C:\xampp\apache\conf\extra\httpd-vhosts.conf`:
```apache
<VirtualHost *:80>
    ServerName gestion-socios.local
    DocumentRoot "C:/xampp/htdocs/GestionSocios/public"
    <Directory "C:/xampp/htdocs/GestionSocios/public">
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```
3. Agregar a `C:\Windows\System32\drivers\etc\hosts`:

### Gestionar Anunciantes
1. Men√∫ ‚Üí "Libro Fiestas" ‚Üí "Anunciantes"
2. Crear nuevo anuncio con:
   - Anunciante (nombre de la empresa/persona)
   - Tipo de anuncio
   - A√±o
   - Estado de pago
3. El precio se asigna autom√°ticamente seg√∫n el tipo

### Gestionar Actividades
1. Men√∫ ‚Üí "Libro Fiestas" ‚Üí "Actividades"
2. Crear actividades del programa:
   - T√≠tulo
   - Descripci√≥n
   - Fecha y hora
   - Ubicaci√≥n

### Maquetaci√≥n y Exportaci√≥n
1. Men√∫ ‚Üí "Libro Fiestas" ‚Üí "Maquetaci√≥n"
2. **Editor visual** con arrastrar y soltar
3. **Sistema de versiones** para guardar diferentes ediciones
4. Exportar a PDF o DOCX
5. Vista previa antes de exportar

## üí∞ Gesti√≥n Financiera

### Dashboard de Tesorer√≠a
- Acceso: Men√∫ ‚Üí "Dashboard" ‚Üí "Tesorer√≠a"
- KPIs: Ingresos totales, gastos totales, balance
- Gr√°ficos de evoluci√≥n mensual
- Desglose por tipo de ingreso/gasto

### Generar Pagos de Cuotas
1. Men√∫ ‚Üí "Configuraci√≥n" ‚Üí Pesta√±a "Socios"
2. Secci√≥n "Generar Pagos de Cuotas"
3. Seleccionar a√±o
4. Clic en "Generar Pagos"
5. Se crear√°n pagos pendientes para todos los socios activos seg√∫n la cuota de su categor√≠a

### Gesti√≥n de Gastos
1. Men√∫ ‚Üí "Gastos"
2. Crear nuevo gasto:
   - Categor√≠a
   - Descripci√≥n
   - Importe
   - Proveedor
   - N√∫mero de factura
   - Comprobante (opcional)
3. Filtrar por a√±o, mes, categor√≠a
4. Exportar a Excel

### Gesti√≥n de Proveedores
1. Men√∫ ‚Üí "Proveedores"
2. Crear proveedor con datos de contacto
3. Subir facturas asociadas
4. Dashboard con estado de facturas y pagos

## üßÆ Contabilidad Avanzada

### Configuraci√≥n Inicial
1. Las tablas contables se crean autom√°ticamente con el schema
2. Se incluye un plan de cuentas b√°sico seg√∫n PGC espa√±ol
3. Se crea autom√°ticamente un per√≠odo contable para el a√±o actual

### Gestionar Plan de Cuentas
1. Men√∫ ‚Üí "Contabilidad" ‚Üí "Plan de Cuentas"
2. Ver todas las cuentas existentes
3. Crear nuevas cuentas especificando:
   - C√≥digo (ej: 570, 700)
   - Nombre descriptivo
   - Tipo: Activo, Pasivo, Patrimonio, Ingresos, Gastos
   - Tipo de saldo: Deudor o Acreedor
   - Cuenta padre (opcional, para subcuentas)
   - Nivel jer√°rquico
4. Editar o desactivar cuentas existentes

### Crear Asientos Contables
1. Men√∫ ‚Üí "Contabilidad" ‚Üí "Libro Diario" ‚Üí "Nuevo Asiento"
2. Completar informaci√≥n:
   - Fecha del asiento
   - Per√≠odo contable
   - Descripci√≥n general
   - Referencia (opcional)
3. A√±adir l√≠neas del asiento:
   - Seleccionar cuenta contable
   - Descripci√≥n de la l√≠nea
   - Importe en Debe o Haber
   - A√±adir todas las l√≠neas necesarias
4. El sistema valida que Debe = Haber
5. Guardar como borrador
6. Contabilizar cuando est√© revisado

### Consultar Libro Mayor
1. Men√∫ ‚Üí "Contabilidad" ‚Üí "Libro Mayor"
2. Seleccionar cuenta a consultar
3. Definir rango de fechas
4. Ver todos los movimientos de la cuenta con saldo acumulado

### Balance de Sumas y Saldos
1. Men√∫ ‚Üí "Contabilidad" ‚Üí "Balance de Sumas"
2. Definir per√≠odo a consultar
3. Ver resumen de todas las cuentas con:
   - Total Debe y Haber
   - Saldos deudores y acreedores
   - Verificaci√≥n autom√°tica de cuadre

## üìä Anal√≠ticas y Reportes

### Dashboard Principal
- Estad√≠sticas de socios (total, activos, inactivos)
- √öltimos pagos y pr√≥ximos vencimientos
- Eventos pr√≥ximos
- Tareas pendientes
- Gr√°ficos de evoluci√≥n

### Dashboard de Eventos
- Men√∫ ‚Üí "Dashboard" ‚Üí "Eventos"
- Estad√≠sticas de asistencia
- Ingresos por eventos
- Eventos m√°s populares

### Exportaciones
- **Excel**: Socios, donantes, pagos, gastos, eventos
- **PDF**: Certificados, reportes
- Todos los listados tienen bot√≥n de exportaci√≥n

## üîê Seguridad

### Recomendaciones
- ‚úÖ Cambiar contrase√±a de `admin` inmediatamente
- ‚úÖ Usar contrase√±as fuertes (m√≠nimo 12 caracteres)
- ‚úÖ Configurar HTTPS para proteger datos (especialmente para GPS)
- ‚úÖ Realizar copias de seguridad semanales
- ‚úÖ Mantener PHP y MySQL actualizados
- ‚úÖ Revisar logs de auditor√≠a regularmente
- ‚úÖ Configurar pol√≠tica de contrase√±as desde Configuraci√≥n
- ‚úÖ Limitar acceso SSH solo a IPs conocidas

### Auditor√≠a
- Men√∫ ‚Üí "Auditor√≠a"
- Registro completo de todas las acciones
- Filtros por usuario, acci√≥n, fecha
- Exportaci√≥n a Excel y PDF

### Pol√≠tica de Contrase√±as
- Men√∫ ‚Üí "Configuraci√≥n" ‚Üí "Pol√≠tica de Contrase√±as"
- Configurar longitud m√≠nima
- Requerir may√∫sculas, min√∫sculas, n√∫meros, s√≠mbolos
- Expiraci√≥n de contrase√±as

## üêõ Soluci√≥n de Problemas

### Error "No se puede conectar a la base de datos"
- Verificar credenciales en `src/Config/config.php`
- Comprobar que MySQL est√° corriendo: `systemctl status mysql`
- Verificar permisos del usuario en MySQL

### Las fotos no se suben
- Verificar permisos de escritura en `public/uploads/`
- Comprobar tama√±o m√°ximo en `php.ini`:
  ```ini
  upload_max_filesize = 10M
  post_max_size = 10M
  ```
- Reiniciar Apache tras cambios

### GPS no funciona
- **Requiere HTTPS**: La API de Geolocalizaci√≥n HTML5 est√° bloqueada en HTTP
- Soluci√≥n temporal: usar entrada manual de coordenadas
- Soluci√≥n permanente: configurar certificado SSL (Let's Encrypt)

### Error 500 en Apache
- Revisar logs: `tail -f /var/log/apache2/error.log`
- Verificar que mod_rewrite est√° habilitado
- Comprobar sintaxis de `.htaccess`

### El mapa no carga
- Verificar conexi√≥n a Internet (usa OpenStreetMap tiles)
- Comprobar consola del navegador (F12) para errores JavaScript
- Verificar que Leaflet.js se carga correctamente

## üöÄ Actualizaci√≥n del Sistema

### Desde Git
```bash
cd /var/www/GestionSocios

# Hacer backup antes de actualizar
mysqldump -u gestion_user -p asociacion_db > backup_pre_update.sql

# Actualizar c√≥digo
git pull origin main

# Aplicar nuevas migraciones si existen
cd database
./apply_all_migrations.sh

# Verificar permisos
sudo chown -R www-data:www-data /var/www/GestionSocios
```

## üìû Soporte y Contribuci√≥n

### Reportar Problemas
- Abrir issue en GitHub: https://github.com/matatunos/GestionSocios/issues
- Incluir:
  - Descripci√≥n del problema
  - Pasos para reproducirlo
  - Versi√≥n de PHP y MySQL
  - Logs relevantes

### Contribuir
1. Fork del repositorio
2. Crear rama para feature: `git checkout -b feature/nueva-funcionalidad`
3. Commit de cambios: `git commit -m "feat: descripci√≥n"`
4. Push a la rama: `git push origin feature/nueva-funcionalidad`
5. Abrir Pull Request

## üìÑ Licencia

Este proyecto est√° bajo licencia MIT. Ver archivo `LICENSE` para m√°s detalles.

## üôè Cr√©ditos

- **Desarrollador**: Nacho (matatunos) - nacho@favala.es
- **Mapas**: Leaflet.js + OpenStreetMap
- **Iconos**: Font Awesome
- **PDF**: TCPDF
- **Gr√°ficos**: Chart.js

---

**Versi√≥n**: 0.5 beta  
**√öltima actualizaci√≥n**: Noviembre 2025  
**Estado**: En desarrollo activo - No se recomienda para producci√≥n sin pruebas exhaustivas

## üéØ Roadmap

### Funcionalidades Implementadas Recientemente
- [x] **M√≥dulo de contabilidad avanzada**
  - Plan de cuentas (Chart of Accounts)
  - Contabilidad por partida doble
  - Libro Diario (Journal Entries)
  - Libro Mayor (General Ledger)
  - Balance de Sumas y Saldos (Trial Balance)
  - Per√≠odos contables
  - Gesti√≥n de asientos contables (borradores y contabilizados)

### Pr√≥ximas Funcionalidades
- [ ] API REST para integraci√≥n con otras aplicaciones
- [ ] App m√≥vil nativa (Android/iOS)
- [ ] Sistema de reservas online
- [ ] Pasarela de pago integrada
- [ ] Firma digital de documentos
- [ ] Integraci√≥n con redes sociales
- [ ] Sistema de newsletters
